<Window x:Class="PinGen.App.Views.AwakenWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:viewmodels="clr-namespace:PinGen.App.ViewModels"
        xmlns:converters="clr-namespace:PinGen.App.Converters"
        mc:Ignorable="d"
        d:DataContext="{d:DesignInstance Type=viewmodels:AwakenWindowViewModel}"
        Title="PinGen"
        Width="1440"
        Height="768"
        MinWidth="1024"
        MinHeight="600">

    <Window.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
        <converters:BoolToColorConverter x:Key="BoolToColorConverter" />

        <!-- Reusable template for each image slot -->
        <DataTemplate x:Key="ImageSlotTemplate">
            <StackPanel Margin="0,0,0,4">
                <!-- File picker row -->
                <Grid Margin="0,4,0,4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <TextBox Grid.Column="0"
                             Text="{Binding SourcePath}"
                             IsReadOnly="True"
                             Background="#1a1a1a"
                             Foreground="#ccc"
                             Padding="4"
                             VerticalContentAlignment="Center" />
                    <Button Grid.Column="1"
                            Content="..."
                            Width="30"
                            Margin="4,0,0,0"
                            Tag="{Binding}"
                            Click="BrowseImage_Click" />
                    <Button Grid.Column="2"
                            Content="✕"
                            Width="24"
                            Margin="4,0,0,0"
                            Tag="{Binding}"
                            Click="ClearSlot_Click"
                            ToolTip="Clear this slot" />
                </Grid>

                <!-- Scale slider -->
                <Grid Margin="0,4,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="40" />
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0"
                               Text="Scale"
                               Foreground="Black"
                               VerticalAlignment="Center"
                               Margin="0,0,8,0" />
                    <Slider Grid.Column="1"
                            Minimum="0.5"
                            Maximum="2.0"
                            Value="{Binding Scale}"
                            TickFrequency="0.1"
                            IsSnapToTickEnabled="True"
                            VerticalAlignment="Center" />
                    <TextBlock Grid.Column="2"
                               Text="{Binding Scale, StringFormat='{}{0:F1}x'}"
                               Foreground="Black"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Right" />
                </Grid>

                <!-- White Removal Options -->
                <StackPanel Margin="0,8,0,0">
                    <CheckBox IsChecked="{Binding EnableWhiteRemoval}"
                              Margin="0,0,0,4">
                        <TextBlock Text="Enable White Removal"
                                   Foreground="{Binding EnableWhiteRemoval, Converter={StaticResource BoolToColorConverter}}" />
                    </CheckBox>
                    <StackPanel Visibility="{Binding EnableWhiteRemoval, Converter={StaticResource BoolToVisibilityConverter}}"
                                Margin="16,0,0,0">
                        <RadioButton GroupName="{Binding GroupName}"
                                     IsChecked="{Binding IsOption1Selected}"
                                     Margin="0,0,0,2">
                            <TextBlock Text="1"
                                       Foreground="{Binding EnableWhiteRemoval, Converter={StaticResource BoolToColorConverter}}" />
                        </RadioButton>
                    </StackPanel>
                </StackPanel>
            </StackPanel>
        </DataTemplate>
    </Window.Resources>

    <Grid Margin="16">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="280" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="300" />
        </Grid.ColumnDefinitions>

        <!-- Column 0: Text Inputs -->
        <StackPanel Grid.Column="0" Margin="0,0,16,0">
            <TextBlock Text="Title" FontWeight="Bold" Margin="0,0,0,4" HorizontalAlignment="Center" />
            <TextBox AcceptsReturn="True" TextWrapping="Wrap" Height="60" Margin="0,0,0,12" Text="{Binding Title, UpdateSourceTrigger=PropertyChanged}"/>

            <TextBlock Text="Subtitle" FontWeight="Bold" Margin="0,0,0,4" HorizontalAlignment="Center" />
            <TextBox AcceptsReturn="True" TextWrapping="Wrap" Height="60" Margin="0,0,0,12" Text="{Binding Subtitle, UpdateSourceTrigger=PropertyChanged}"/>
            
            <TextBlock Text="Captions" FontWeight="Bold" Margin="0,0,0,4" HorizontalAlignment="Center" />
            <TextBox TextWrapping="Wrap" Margin="0,0,0,4" Text="{Binding Captions[0], UpdateSourceTrigger=PropertyChanged}"/>
            <TextBox TextWrapping="Wrap" Margin="0,0,0,4" Text="{Binding Captions[1], UpdateSourceTrigger=PropertyChanged}"/>
            <TextBox TextWrapping="Wrap" Margin="0,0,0,12" Text="{Binding Captions[2], UpdateSourceTrigger=PropertyChanged}"/>

            <!-- Footer with Optional Toggle -->
            <StackPanel Margin="0,0,0,4">
                <CheckBox x:Name="EnableFooterCheckBox"
                          Content="Enable Footer"
                          IsChecked="{Binding IsFooterEnabled}"
                          HorizontalAlignment="Center"
                          FontWeight="Bold"
                          Margin="0,0,0,4" />
            </StackPanel>
            <TextBox AcceptsReturn="True" 
                     TextWrapping="Wrap" 
                     Height="60" 
                     Margin="0,0,0,12"
                     IsEnabled="{Binding IsFooterEnabled}"
                     Opacity="{Binding IsFooterEnabled, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Opacity}" Text="{Binding Footer, UpdateSourceTrigger=PropertyChanged}"/>

            <Button Content="Clear All Text" HorizontalAlignment="Center" Padding="12,6" Margin="0,0,0,16" />

            <!-- Background Options Section -->
            <Separator Margin="0,0,0,12" />
            <TextBlock Text="Background Options" FontWeight="Bold" Margin="0,0,0,8" HorizontalAlignment="Center" />

            <StackPanel Margin="0,0,0,8">
                <RadioButton Content="Background 1 (bg1)"
                             GroupName="BackgroundChoice"
                             IsChecked="{Binding UseBackground1}"
                             Margin="0,0,0,4" />
                <RadioButton Content="Background 2 (bg2)"
                             GroupName="BackgroundChoice"
                             IsChecked="{Binding UseBackground2}"
                             Margin="0,0,0,4" />
                <RadioButton Content="Custom Color"
                             GroupName="BackgroundChoice"
                             IsChecked="{Binding UseCustomColor}"
                             Margin="0,0,0,8" />
            </StackPanel>

            <!-- Color Palette (visible when Custom Color selected) -->
            <StackPanel Visibility="{Binding UseCustomColor, Converter={StaticResource BoolToVisibilityConverter}}"
                        Margin="16,0,0,0">
                <TextBlock Text="Select Color:" Foreground="#888" Margin="0,0,0,4" />
                <WrapPanel>
                    <RadioButton GroupName="ColorPalette" Margin="2" IsChecked="{Binding IsWhiteSelected}">
                        <RadioButton.Template>
                            <ControlTemplate TargetType="RadioButton">
                                <Border Width="24" Height="24" Background="White" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="2" CornerRadius="2" Cursor="Hand" />
                            </ControlTemplate>
                        </RadioButton.Template>
                    </RadioButton>
                    <RadioButton GroupName="ColorPalette" Margin="2" IsChecked="{Binding IsBlackSelected}">
                        <RadioButton.Template>
                            <ControlTemplate TargetType="RadioButton">
                                <Border Width="24" Height="24" Background="Black" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="2" CornerRadius="2" Cursor="Hand" />
                            </ControlTemplate>
                        </RadioButton.Template>
                    </RadioButton>
                    <RadioButton GroupName="ColorPalette" Margin="2" IsChecked="{Binding IsRedSelected}">
                        <RadioButton.Template>
                            <ControlTemplate TargetType="RadioButton">
                                <Border Width="24" Height="24" Background="#E74C3C" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="2" CornerRadius="2" Cursor="Hand" />
                            </ControlTemplate>
                        </RadioButton.Template>
                    </RadioButton>
                    <RadioButton GroupName="ColorPalette" Margin="2" IsChecked="{Binding IsBlueSelected}">
                        <RadioButton.Template>
                            <ControlTemplate TargetType="RadioButton">
                                <Border Width="24" Height="24" Background="#3498DB" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="2" CornerRadius="2" Cursor="Hand" />
                            </ControlTemplate>
                        </RadioButton.Template>
                    </RadioButton>
                    <RadioButton GroupName="ColorPalette" Margin="2" IsChecked="{Binding IsGreenSelected}">
                        <RadioButton.Template>
                            <ControlTemplate TargetType="RadioButton">
                                <Border Width="24" Height="24" Background="#2ECC71" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="2" CornerRadius="2" Cursor="Hand" />
                            </ControlTemplate>
                        </RadioButton.Template>
                    </RadioButton>
                    <RadioButton GroupName="ColorPalette" Margin="2" IsChecked="{Binding IsYellowSelected}">
                        <RadioButton.Template>
                            <ControlTemplate TargetType="RadioButton">
                                <Border Width="24" Height="24" Background="#F1C40F" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="2" CornerRadius="2" Cursor="Hand" />
                            </ControlTemplate>
                        </RadioButton.Template>
                    </RadioButton>
                    <RadioButton GroupName="ColorPalette" Margin="2" IsChecked="{Binding IsPurpleSelected}">
                        <RadioButton.Template>
                            <ControlTemplate TargetType="RadioButton">
                                <Border Width="24" Height="24" Background="#9B59B6" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="2" CornerRadius="2" Cursor="Hand" />
                            </ControlTemplate>
                        </RadioButton.Template>
                    </RadioButton>
                    <RadioButton GroupName="ColorPalette" Margin="2" IsChecked="{Binding IsOrangeSelected}">
                        <RadioButton.Template>
                            <ControlTemplate TargetType="RadioButton">
                                <Border Width="24" Height="24" Background="#E67E22" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="2" CornerRadius="2" Cursor="Hand" />
                            </ControlTemplate>
                        </RadioButton.Template>
                    </RadioButton>
                </WrapPanel>
            </StackPanel>
        </StackPanel>

        <!-- Column 1: Preview Area with 2:3 aspect ratio (1000x1500) -->
        <Border Grid.Column="1"
                Background="#1a1a1a"
                BorderBrush="#333"
                BorderThickness="1"
                Margin="0,0,16,0">
            <Viewbox Stretch="Uniform" StretchDirection="Both">
                <Border Width="1000" Height="1500" Background="#222">
                    <Grid>
                        <TextBlock Text="Preview"
                                   Foreground="#666"
                                   FontSize="48"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center" />
                        <!-- Future: Image control bound to preview bitmap -->
                        <Image Source="{Binding PreviewImage}" Stretch="Uniform" />
                    </Grid>
                </Border>
            </Viewbox>
        </Border>

        <!-- Column 2: Image Slots Panel -->
        <Grid Grid.Column="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <TextBlock Grid.Row="0"
                       Text="Item Images"
                       FontWeight="Bold"
                       Margin="0,0,0,8" />

            <!-- Scrollable 8 Expander Slots -->
            <ScrollViewer Grid.Row="1" 
                          VerticalScrollBarVisibility="Auto"
                          Margin="0,0,0,12">
                <StackPanel>
                    <Expander Header="Slot 1" IsExpanded="False" Margin="0,0,0,4">
                        <ContentControl Content="{Binding Slot1}" 
                                        ContentTemplate="{StaticResource ImageSlotTemplate}" />
                    </Expander>
                    <Expander Header="Slot 2" IsExpanded="False" Margin="0,0,0,4">
                        <ContentControl Content="{Binding Slot2}" 
                                        ContentTemplate="{StaticResource ImageSlotTemplate}" />
                    </Expander>
                    <Expander Header="Slot 3" IsExpanded="False" Margin="0,0,0,4">
                        <ContentControl Content="{Binding Slot3}" 
                                        ContentTemplate="{StaticResource ImageSlotTemplate}" />
                    </Expander>
                    <Expander Header="Slot 4" IsExpanded="False" Margin="0,0,0,4">
                        <ContentControl Content="{Binding Slot4}" 
                                        ContentTemplate="{StaticResource ImageSlotTemplate}" />
                    </Expander>
                    <Expander Header="Slot 5" IsExpanded="False" Margin="0,0,0,4">
                        <ContentControl Content="{Binding Slot5}" 
                                        ContentTemplate="{StaticResource ImageSlotTemplate}" />
                    </Expander>
                    <Expander Header="Slot 6" IsExpanded="False" Margin="0,0,0,4">
                        <ContentControl Content="{Binding Slot6}" 
                                        ContentTemplate="{StaticResource ImageSlotTemplate}" />
                    </Expander>
                    <Expander Header="Slot 7" IsExpanded="False" Margin="0,0,0,4">
                        <ContentControl Content="{Binding Slot7}" 
                                        ContentTemplate="{StaticResource ImageSlotTemplate}" />
                    </Expander>
                    <Expander Header="Slot 8" IsExpanded="False" Margin="0,0,0,4">
                        <ContentControl Content="{Binding Slot8}" 
                                        ContentTemplate="{StaticResource ImageSlotTemplate}" />
                    </Expander>
                </StackPanel>
            </ScrollViewer>

            <!-- Bottom Buttons -->
            <StackPanel Grid.Row="2" Orientation="Vertical">
                <Button Content="Clear All Images"
                        Margin="0,0,0,8"
                        Padding="8,6"
                        Click="ClearImages_Click" />
                <Separator Margin="0,4,0,12" />
                <Button Content="Generate Preview"
                        Command="{Binding GeneratePreviewCommand}"
                        Padding="8,6"
                        Margin="0,0,0,8" />
                <Button Content="Render &amp; Save"
                        Command="{Binding RenderCommand}"
                        Padding="8,6"
                        FontWeight="Bold" />
            </StackPanel>
        </Grid>
    </Grid>
</Window>

